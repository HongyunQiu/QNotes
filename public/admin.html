<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QNotes 管理后台</title>
    <link rel="stylesheet" href="styles.css" />
    <style>
      .admin-container { padding: 16px; }
      .admin-grid { display: grid; grid-template-columns: 1fr; gap: 16px; }
      .card { background: #fff; border: 1px solid #eee; border-radius: 8px; padding: 16px; }
      .card h2 { margin: 0 0 12px 0; font-size: 18px; }
      .meta { color: #666; font-size: 12px; }
      table { width: 100%; border-collapse: collapse; }
      th, td { text-align: left; padding: 8px; border-bottom: 1px solid #f0f0f0; }
      th { background: #fafafa; }
      .pill { display: inline-block; padding: 2px 8px; border-radius: 12px; font-size: 12px; }
      .pill-admin { background: #f0f9eb; color: #52c41a; border: 1px solid #b7eb8f; }
      .topbar .actions { display: flex; gap: 8px; align-items: center; }
    </style>
  </head>
  <body>
    <header class="topbar">
      <div class="brand">QNotes 管理</div>
      <div class="spacer"></div>
      <div class="actions">
        <a id="back-to-app" class="tab" href="index.html">返回应用</a>
        <button id="logout-btn">退出</button>
      </div>
    </header>
    <main class="admin-container">
      <div class="admin-grid">
        <section class="card">
          <h2>授权模式</h2>
          <div class="meta">选择个人模式或团队模式</div>
          <div style="margin-top:8px; display:flex; gap:8px; align-items:center;">
            <label for="auth-mode-select">模式：</label>
            <select id="auth-mode-select">
              <option value="team">团队模式（按二级节点分组授权）</option>
              <option value="personal">个人模式（仅查看自己的笔记）</option>
            </select>
            <button id="save-auth-mode-btn">保存</button>
            <span id="auth-mode-status" class="meta"></span>
          </div>
        </section>
        <section class="card">
          <h2>数据库概览</h2>
          <div id="db-summary" class="meta">加载中…</div>
        </section>
        <section class="card">
          <h2>附件概览</h2>
          <div id="uploads-summary" class="meta">加载中…</div>
        </section>
        <section class="card">
          <h2>磁盘剩余空间</h2>
          <div id="disk-summary" class="meta">加载中…</div>
        </section>
        <section class="card">
          <h2>用户列表</h2>
          <div class="meta">仅超级管理员可见</div>
          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>用户名</th>
                <th>角色</th>
                <th>笔记数</th>
                <th>创建时间</th>
              </tr>
            </thead>
            <tbody id="users-tbody">
              <tr><td colspan="5" class="meta">加载中…</td></tr>
            </tbody>
          </table>
        </section>
        <section class="card">
          <h2>用户组管理</h2>
          <div class="meta">创建/删除组，配置用户成员关系</div>
          <div style="margin:8px 0; display:flex; gap:8px;">
            <input id="new-group-name" placeholder="新建组名称" />
            <button id="create-group-btn">创建</button>
          </div>
          <div id="groups-list" class="meta">加载中…</div>
          <div id="memberships-panel" style="margin-top:12px; overflow:auto;"></div>
        </section>
        <section class="card">
          <h2>二级节点授权</h2>
          <div class="meta">为每个二级节点设置所属组（未设置表示公开）</div>
          <div id="sections-panel" style="margin-top:8px;" class="meta">加载中…</div>
        </section>
        <section class="card">
          <h2>表结构</h2>
          <div id="tables-info" class="meta">加载中…</div>
        </section>
        <section class="card">
          <h2>数据备份</h2>
          <div class="meta">内容包含：/data、/public/uploads、/public/vendor</div>
          <div style="margin-top: 8px;">
            <button id="backup-btn">下载备份</button>
          </div>
          <div id="backup-status" class="meta" style="margin-top: 8px;"></div>
          <div id="backup-progress" style="height: 8px; background: #f5f5f5; border-radius: 4px; overflow: hidden; margin-top: 6px; display: none;">
            <div id="backup-progress-bar" style="height: 100%; width: 0%; background: #52c41a;"></div>
          </div>
        </section>
      </div>
    </main>
    <script src="admin.js"></script>
  </body>
  </html>


