### 功能概述

为左侧“我的笔记”的层级式菜单新增拖拽移动功能：
- 支持将一个笔记拖拽到另一笔记上，成为其子节点（改变 `parent_id`）。
- 支持将笔记拖拽到树的空白区域，使其成为根级笔记（`parent_id = null`）。
- 拖拽过程提供视觉反馈；移动后刷新树并尽量保持展开/选中状态。

### 后端改动

- 新增接口：`POST /api/notes/:id/move`
  - 请求体：`{ parent_id: number | null }`
  - 返回：`{ success: true }`
  - 校验逻辑：
    - `id` 必须存在；`parent_id` 若非空需对应存在的笔记。
    - 禁止把节点移动到自身之下（`id === parent_id`）。
    - 禁止把节点移动到其后代之下（向上回溯父链的循环检测）。
  - 实现位置：`src/server.js`

### 前端改动

- 文件：`public/app.js`
  - 在树渲染函数 `buildTreeList` 中：
    - 为每个 `li.tree-item` 启用原生拖拽（`draggable=true`）。
    - 绑定 `dragstart / dragend / dragover / drop`，在 `drop` 时调用 `moveNote(sourceId, targetId)`。
  - 在应用事件初始化 `setupEventListeners` 中：
    - 给 `#note-tree` 作为根层绑定 `dragover / drop`，若悬停非任何 `li`，允许将条目拖到根（`moveNote(sourceId, null)`)。
  - 新增方法：`moveNote(sourceId, newParentId)`
    - 调用后端 `POST /notes/:id/move`，成功后 `loadTree()` 并恢复展开/高亮状态。

- 文件：`public/styles.css`
  - 新增拖拽反馈样式：
    - `.tree-item.dragging { opacity: 0.6; }`
    - `.tree-item.drag-over { background: rgba(59, 130, 246, 0.15); }`
    - `.note-tree.drop-root { outline: 2px dashed var(--primary); background: rgba(59,130,246,0.05); }`

### 使用说明（前端）

1. 在“我的笔记”树中按下鼠标拖动一个笔记条目：
   - 拖到另一个条目上并松开：该笔记成为目标条目的子节点。
   - 拖到树的空白区域并松开：该笔记成为根级节点。
2. 发生移动后会自动刷新左侧树结构并保持尽可能的展开与当前选中高亮。

### 错误与提示

- 当移动非法（如拖到自身或其后代）时，后端会返回 400，前端以通知方式提示“移动失败”。
- 成功移动会提示“移动成功”。

### 现有限制

- 目前仅调整层级（父子关系），不改变同层顺序。树的排序仍按原逻辑（父/标题）进行。
- 如需支持“同层排序拖拽”，建议：
  1) 数据库为 `notes` 增加 `position` 字段；
  2) 后端提供更新顺序的接口；
  3) 前端根据相对位置（前/后）计算并更新 `position`。

### 相关文件

- `src/server.js`：新增 `POST /api/notes/:id/move` 路由。
- `public/app.js`：拖拽逻辑、`moveNote` 方法、根层接收处理。
- `public/styles.css`：拖拽视觉反馈样式。

### 验证建议

1. 在树中创建若干笔记，展开/收起多级结构；
2. 拖拽 A 到 B 上，确认 A 成为 B 的子节点；
3. 拖拽 A 到树空白处，确认 A 成为根级节点；
4. 尝试把某节点拖到其子孙节点上，确认被拒绝并提示失败；
5. 刷新页面，确认前一次移动后的结构正确显示。


